@let activeStep = (activeStep$ | async);
@let pdfDocs = (documents$ | async) ?? [];


<!-- ===================== -->
<!-- ðŸ§­ STEPPER PRINCIPAL -->
<!-- ===================== -->
<div class="container py-4">
  <p-card class="shadow-1 border-round-xl">
    <app-app-stepper
      [steps]="steps"
      [activeIndex]="activeStep ?? 0"
      (stepChange)="goToStep($event)">
    </app-app-stepper>
  </p-card>
</div>

<!-- ===================== -->
<!-- ðŸ“¦ CONTENIDO DEL PASO -->
<!-- ===================== -->
<div class="container-fluid">
  <div class="row justify-content-center">

    <!-- Paso 0 -->
    @if (activeStep === 0) {
      <div class="step-content">
        <app-dynamic-form
          [formConfig]="currentForm"
          [pageIndex]="0">
        </app-dynamic-form>
      </div>
    }

    <!-- Paso 1 -->
    @if (activeStep === 1) {
      <div class="step-content">
        <app-upload-documents></app-upload-documents>
      </div>
    }

    <!-- Paso 2 -->
    @if (activeStep === 2 && pdfDocs?.length) {
      <div class="step-content">
        <app-pdf-preview-list
          [documents]="pdfDocs"
          (signaturePosition)="onSignatureCaptured($event)">
        </app-pdf-preview-list>
      </div>
    }

    <!-- Paso 3 -->
    @if (activeStep === 3) {
      <div class="step-content">
        <app-validate-pdf></app-validate-pdf>
      </div>
    }

    <!-- Paso 4 -->
    @if (activeStep === 4) {
      <div class="step-content">
        <app-sing-pdf
          (htmlChange)="onHtmlChange($event)">
        </app-sing-pdf>
      </div>
    }

  </div>
</div>

<!-- ===================== -->
<!-- â¬…ï¸âž¡ï¸ BOTONES DE NAVEGACIÃ“N -->
<!-- ===================== -->
<p-toolbar class="step-toolbar shadow-1 border-round-xl p-3">

  <div class="p-toolbar-group-start">
    <button
      pButton
      label="AtrÃ¡s"
      icon="pi pi-arrow-left"
      class="p-button-text p-button-secondary"
      (click)="goToStep((activeStep ?? 0) - 1)"
      [disabled]="activeStep === 0">
    </button>
  </div>

  <div class="p-toolbar-group-end">
    <button
      pButton
      label="Siguiente"
      icon="pi pi-arrow-right"
      iconPos="right"
      class="p-button-raised p-button-primary"
      (click)="goToStep((activeStep ?? 0) + 1)"
      [disabled]="!canAdvance()">
    </button>
  </div>
  <div class="row">
      <button
  pButton
  label="Firmar grafolÃ³gicamente"
  class="p-button-secondary"
  (click)="signGraphological()">
</button>

    
  </div>

</p-toolbar>
